#include<stdio.h>

double x_impulse[512] = { 0 };
double x_step[512] = { 0 };
double y_impulse[512] = { 0 };
double y_step[512] = { 0 };

double h_fir[100] = { 1.000000000000000, 0.000000000000000, -1.660000000000000, 0.000000000000000, 0.991000000000000, 0.000000000000000,
-0.572574000000000, 0.000000000000000, 0.397471740000000, 0.000000000000000, -0.251830883000000, 0.000000000000000, 0.158408139126000,
0.000000000000000, -0.102554811414860, 0.000000000000000, 0.065573101903303, 0.000000000000000, -0.041846952656028, 0.000000000000000,
0.026825148965167, 0.000000000000000, -0.017166574505281, 0.000000000000000, 0.010981093637207, 0.000000000000000, -0.007029194740280,
0.000000000000000, 0.004498493318484, 0.000000000000000, -0.002878681753762, 0.000000000000000, 0.001842322040968, 0.000000000000000,
-0.001179029368984, 0.000000000000000, 0.000754531383072, 0.000000000000000, -0.000482877327900, 0.000000000000000, 0.000309025780655,
0.000000000000000, -0.000197765935184, 0.000000000000000, 0.000126563733952, 0.000000000000000, -0.000080996616832, 0.000000000000000,
0.000051835141423, 0.000000000000000, -0.000033172778315, 0.000000000000000, 0.000021229481345, 0.000000000000000, -0.000013586165163,
0.000000000000000, 0.000008694696311, 0.000000000000000, -0.000005564318017, 0.000000000000000, 0.000003560979420, 0.000000000000000,
-0.000002278909020, 0.000000000000000, 0.000001458426379, 0.000000000000000, -0.000000933344631, 0.000000000000000, 0.000000597309685,
0.000000000000000, -0.000000382258437, 0.000000000000000, 0.000000244632753, 0.000000000000000, -0.000000156556869, 0.000000000000000,
0.000000100191216, 0.000000000000000, -0.000000064119064, 0.000000000000000, 0.000000041034080, 0.000000000000000, -0.000000026260453,
0.000000000000000, 0.000000016805821, 0.000000000000000, -0.000000010755170, 0.000000000000000, 0.000000006882953, 0.000000000000000,
-0.000000004404862, 0.000000000000000, 0.000000002818966, 0.000000000000000, -0.000000001804045, 0.000000000000000, 0.000000001154529,
0.000000000000000, -0.000000000738860, 0.000000000000000 };

void generateImpulse(double* impulse, int size)
{
	impulse[0] = 1.0;
	int i;
	for (i = 1; i < size; i++)
		impulse[i] = 0;
}
void generateStep(double* step, int size)
{
	int i;
	for (i = 0; i < 100; i++)
		step[i] = 1;
	for (i = 100; i < size; i++)
		step[i] = 0;
}

void convolve(double* x, double* h, double* y, int x_size, int h_size)
{
	int N = x_size + h_size - 1;
	int n, i;
	for (n = 0; n < N; n++)
		for (i = 0; i < x_size; i++)
			if (((n - i) >= 0) && ((n - i) < h_size))
				y[n] += x[i] * h[n - i];
}


void printArray(double* array, int size) {
	int i;
	for (i = 0; i < size; i++)
		printf("%0.15f, ", array[i]);
}

int main(void)
{
	generateImpulse(x_impulse, 512);
	generateStep(x_step, 512);
	convolve(x_impulse, h_fir, y_impulse, 512, 100);
	printf("Impulsni odziv FIR filtra: \n");
	printArray(y_impulse, 512);
	convolve(x_step, h_fir, y_step, 512, 100);
	printf("\nOdziv na step FIR filtra: \n");
	printArray(y_step, 512);

	return 0;
}